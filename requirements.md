# ショート動画自動生成ツール 要件定義書

**作成日**: 2025年9月10日  
**対象**: YouTube Shorts / TikTok / Instagram Reels対応縦型動画自動生成システム

## 1. プロジェクト概要

### 1.1 目的
スクリプトから完全自動で縦型ショート動画を生成するローカル動作ツールの開発。
画像生成、音声合成、字幕設置、簡単なアニメーション効果を統合し、ユーザーが最小限の入力で高品質なショート動画を制作できるシステムを構築する。

### 1.2 基本方針
- **完全ローカル動作**: インターネット不要で動作
- **最短・シンプル**: 複雑な設定不要、直感的操作
- **余計な機能排除**: 必要最小限の機能に特化
- **ベストプラクティス採用**: 2025年最新技術の活用

### 1.3 対象動画仕様
- **解像度**: 1080px × 1920px (9:16 縦型)
- **フレームレート**: 30fps
- **最大長**: 60秒（YouTube Shorts対応）
- **対応フォーマット**: MP4 (H.264)

## 2. 参考動画分析結果

### 2.1 動画構成パターン
参考画像（92フレーム）の分析により判明した基本構造：

#### 第1セクション: タイトル・導入部 (1-39フレーム)
- **静止タイトル画面**: 13フレーム静止表示
- **フェード効果**: グレー調への段階的変化
- **タイプライター効果**: 文字単位での段階的テキスト表示

#### 第2セクション: ストーリー展開部 (40-74フレーム)
- **劇的シーン転換**: 環境・キャラクター・色調の完全変化
- **複数シーン**: 朝の日常 → ジム → 飛行機 → 高級品 → 夜の学習
- **各シーン持続**: 4-5フレーム程度

#### 第3セクション: 結論・メッセージ部 (75-92フレーム)
- **最終メッセージ**: 図書館・書斎での学習シーン
- **段階的テキスト表示**: 重要メッセージの強調表示

### 2.2 アニメーション効果パターン

#### A. テキストアニメーション
**※参考画像は30秒動画を3fpsで抽出（実際は30fps = 10倍密度）**

##### A-1. 文字サイズ階層構造（シーン別）
**シーン1（強調タイトル）**:
- **メインタイトル**: 「東大卒社長の父」→ 36pt（最大サイズ）
- **サブタイトル**: 「が明かした」→ 24pt（中サイズ）  
- **強調テキスト**: グレーボックス内 → 28pt（大サイズ）
- **ナレーション**: 下部固定 → 20pt（標準サイズ）

**その他シーン**: 文字サイズ構造は各シーンの内容・強調度に応じて変動

##### A-2. 色変化パターン詳細
- **基本カラー**: 黒文字（#000000）メイン使用
- **強調色**: 赤色（#FF0000）で重要キーワード「人の夢や目標」等を強調
- **背景対応**: 明るいグレー背景（#F5F5F5）上での高コントラスト確保
- **フェード変化**: 透明度26フレーム（0.87秒）で段階的変化

##### A-3. 配置・レイアウトパターン
- **3層構造**: 上部タイトル → 中央メイン → 下部ナレーション
- **中央寄せ**: タイトル・メインテキスト（画面中心軸）
- **左寄せ**: 下部ナレーション（固定位置 Y=480px）
- **グレーボックス**: 中央テキスト用背景（#E8E8E8、角丸なし）

##### A-4. アニメーション技術仕様
- **タイプライター効果**: 1文字/1フレーム（30fps = 33.33ms間隔）、カーソル効果なし
- **フェードイン**: 30-50フレームでの滑らかな透明度変化（ease-out）
- **色彩強調**: 瞬時の色変更（黒→赤、フレーム単位切り替え）
- **フォント**: 日本語ゴシック体（推奨：Noto Sans JP、Regular 400）
- **多言語対応**: 漢字・ひらがな・カタカナ完全対応

#### B. 画像・背景効果
- **フェードアウト/ホワイトアウト**: 30-60フレームでのシーン転換準備
- **完全シーン切り替え**: 瞬時の背景・人物変更
- **グラデーション効果**: 20-40フレームでの人物画像透明度調整

#### C. シーン転換効果
- **段階的遷移**: 30-90フレームでの滑らかなフェード系効果
- **劇的変化**: 1-3フレームでの完全環境変更
- **色調統一**: シーン内での一貫した色彩

## 3. 技術仕様

### 3.1 採用技術スタック

#### コア技術
- **言語**: Python 3.8+
- **動画フレームワーク**: MoviePy (FFmpeg backend)
- **画像生成**: Flux.1 Dev API（外部API、非商用無料・商用安価、高品質リアル描画）
- **音声合成**: VOICEVOX (ローカル動作)
- **アニメーション**: Manim Community Edition (テキスト効果)

#### 補助ライブラリ
- **画像処理**: Pillow, OpenCV-Python
- **テキスト処理**: fontTools
- **数値計算**: NumPy
- **設定管理**: PyYAML

### 3.2 システム構成 (MVP)

```
ShortsAI/
├── main.py                    # シンプルなエントリーポイント
├── video_generator.py         # コア機能のみ
├── image_generator.py         # Flux.1基本実装
├── voice_synthesizer.py       # VOICEVOX基本実装
├── youtube_uploader.py        # 基本アップロードのみ
└── config.yaml                # 最小設定
```

## 4. 機能要件

### 4.1 必須機能

#### A. スクリプト解析機能
- **入力形式**: JSON, YAML, または専用DSL
- **解析項目**:
  - シーン構成とタイミング
  - テキスト内容と表示タイミング
  - 画像生成プロンプト
  - 音声読み上げテキスト
  - エフェクト指定

#### B. AI画像生成機能（Flux.1 Dev）
- **エンジン**: Flux.1 Dev（Black Forest Labs開発）
- **インターフェース**: Flux.1 API経由またはReplicate/fal.aiプラットフォーム
- **生成仕様**: 1080×1920px高解像度（2K解像度対応）
- **品質特徴**: 高品質リアル描画、優秀なテキスト描画性能
- **バッチ処理**: 複数画像同時生成対応
- **カスタマイズ**: ref-images風プロンプトテンプレート使用
- **ステップ数**: 20-50ステップ（推奨は30-40ステップ）
- **コスト**: 非商用無料、商用利用時は安価API料金

#### C. 音声合成機能
- **エンジン**: VOICEVOX
- **API**: REST API経由制御
- **音声品質**: 44.1kHz/16bit
- **話者**: 単一話者での基本読み上げのみ

#### D. テキストアニメーション機能
- **タイプライター効果**:
  - 文字単位出現制御（1-3フレーム間隔）
  - 多言語フォント対応
  - 可変速度設定
- **フェードイン/アウト**:
  - 透明度段階制御
  - カスタム曲線対応
- **色彩効果**:
  - グラデーション表示
  - キーワード強調
  - 動的色変更

#### E. シーン管理機能
- **シーン定義**: 開始/終了フレーム指定
- **遷移効果**: フェード、ワイプ、カット
- **背景管理**: 画像合成、透明度制御
- **レイヤー管理**: テキスト、画像、エフェクトレイヤー

## 5. 非機能要件

### 5.1 性能要件
- **生成速度**: 「動作すること」を優先し、具体的な速度目標は設けない
- **リソース**: CPU使用率やメモリ管理の厳密な制限は設けない

### 5.2 品質要件
- **画像品質**: 1080p高画質維持
- **音声品質**: クリアな音声出力
- **動画品質**: 滑らかなアニメーション
- **エラー処理**: 詳細なエラーメッセージ

### 5.3 互換性要件
- **OS対応**: Windows 10+, macOS 12+, Ubuntu 20.04+
- **Python**: 3.8-3.12対応
- **依存関係**: 最小限の外部依存
- **GPU**: CUDA対応推奨（必須ではない）

### 5.4 保守性要件
- **モジュール設計**: 高い凝集度、低い結合度
- **設定外部化**: 設定ファイルによる制御

## 6. ユーザーインターフェース要件

### 6.1 基本UI
- **コマンドライン**: 基本操作インターフェース
- **設定ファイル**: YAML形式での詳細設定
- **テンプレート**: 再利用可能な設定群

### 6.2 入力仕様

#### スクリプトファイル例（YAML形式）
```yaml
video:
  title: "サンプル動画"
  duration: 30
  template: "educational"

scenes:
  - id: 1
    duration: 10
    background:
      type: "generated"
      prompt: "professional office environment"
    text:
      content: "東大卒社長の父が明かした"
      animation: "typewriter"
      speed: 2
    voice:
      text: "とうだいそつしゃちょうのちちがあかした"
      speaker: "zundamon"

  - id: 2
    duration: 20
    background:
      type: "generated"
      prompt: "young man working at desk"
    text:
      content: "実は賢い人ほどバカなフリをする理由"
      animation: "fade_in"
      color: "#ff0000"
    voice:
      text: "じつはかしこいひとほどばかなふりをするりゆう"
      speaker: "zundamon"
```

### 6.3 出力仕様
- **動画ファイル**: MP4形式、指定ディレクトリに出力
- **進捗ログ**: コンソール表示 + ログファイル
- **エラーレポート**: 詳細なエラー情報
- **統計情報**: 処理時間、リソース使用量

## 7. 開発・運用要件

### 7.1 開発環境
- **言語**: Python 3.8+
- **開発ツール**: VSCode, PyCharm対応
- **パッケージ管理**: pip, conda両対応
- **バージョン管理**: Git

### 7.2 外部依存関係
- **必須**: FFmpeg, VOICEVOX Core
- **推奨**: CUDA Toolkit（GPU加速用）
- **オプション**: ComfyUI（画像生成品質向上）

### 7.3 インストール要件
- **インストーラー**: ワンクリックインストール対応
- **依存関係**: 自動依存関係解決
- **設定**: 初回起動時の自動設定

### 7.4 ドキュメント要件
- **README**: 基本的な使い方
- **API文書**: 詳細な関数仕様
- **チュートリアル**: ステップバイステップガイド
- **トラブルシューティング**: よくある問題と解決法

## 8. リスク分析

### 8.1 技術リスク
- **AI生成品質**: 期待する品質が得られない可能性
- **処理速度**: 高品質生成による処理時間増大
- **メモリ不足**: 大きな画像・動画処理によるメモリ不足
- **依存関係**: 外部ツールのバージョン不整合

### 8.2 対策
- **品質**: 複数生成オプション、品質設定調整機能
- **速度**: 並列処理、品質レベル選択機能
- **メモリ**: メモリ使用量監視、自動ガベージコレクション
- **依存関係**: Docker化、仮想環境推奨

## 9. 成功基準

### 9.1 機能的成功基準
- ✅ スクリプトから60秒動画を完全自動生成
- ✅ タイプライター効果の正確な実装
- ✅ 高品質AI画像生成の統合
- ✅ 自然な音声合成の組み込み
- ✅ 滑らかなシーン遷移効果

### 9.2 非機能的成功基準
- ✅ 10分以内での動画生成完了
- ✅ ローカル環境での完全動作
- ✅ 直感的で分かりやすい操作性
- ✅ 安定した動作（クラッシュ率1%以下）

### 9.3 ビジネス成功基準
- ✅ ユーザビリティテストでの高評価（4/5以上）
- ✅ 技術文書の完全性
- ✅ 拡張可能なアーキテクチャの実現

## 10. 今後の拡張可能性

### 10.1 短期拡張（v1.1 - v1.3）
- **音楽トラック**: BGM自動追加機能
- **キャラクター**: アバター画像生成
- **エフェクト**: 追加視覚効果
- **テンプレート**: 業界特化テンプレート

### 10.2 中期拡張（v2.0 - v3.0）
- **AI脚本生成**: GPT統合による自動脚本作成
- **動的アニメーション**: より複雑な動きの生成
- **多言語対応**: 英語、中国語等の多言語
- **クラウド連携**: オプショナルクラウド機能

### 10.3 長期拡張（v4.0+）
- **リアルタイム生成**: ライブ配信対応
- **AI演出**: 自動演出提案機能
- **コラボレーション**: チーム制作機能
- **収益化**: 商用利用対応

## 11. YouTube自動アップロード機能要件（MVP）

### 11.1 概要
動画生成完了後、自動的にYouTubeチャンネルにアップロードする基本機能。

### 11.2 機能仕様 (MVP)
- **認証**: OAuth 2.0を使用し、ユーザーが手動で認証を行う。認証情報はローカルに保存・再利用される。
- **アップロード**: 生成されたMP4ファイルを指定されたチャンネルにアップロードする。
- **メタデータ**: スクリプトから取得したタイトルと説明文を設定する。
- **プライバシー**: デフォルトは `private`（非公開）とする。

### 11.3 対象外の機能 (MVP)
- サムネイル自動生成
- 公開スケジュール設定
- 高度なメタデータ自動生成（タグの自動抽出など）
- アナリティクス取得
- 複数アカウント対応